app.ff.ScoreScene=function(){var e=Class.inherit(this,app.Scene,["scoreScene","img/scoreBackground2.jpg"]);var i={};i.fishermanScale=.66;i.trashScale=.66;i.price=[0,0,0];i.exitSign=new app.gfx.Sprite("abortButton","img/abortButton.png",1,9250,710,1070,1070);i.trash1=new app.gfx.Sprite("score.fish1","img/trash1.png",4,0,0,i.trashScale*5840/4,i.trashScale*2690);i.trash2=new app.gfx.Sprite("score.fish2","img/trash2.png",4,0,0,i.trashScale*4800/4,i.trashScale*2570);i.trash3=new app.gfx.Sprite("score.fish3","img/trash3.png",4,0,0,i.trashScale*8200/4,i.trashScale*1330);i.body=new app.gfx.Sprite("score.body","img/ffBody.png",1,7480-880*i.fishermanScale,9610+2860*i.fishermanScale,i.fishermanScale*3870,i.fishermanScale*4620);i.head=new app.gfx.Sprite("score.head","img/ffHead"+app.ff.State.difficulty()+".png",2,7480,9610,i.fishermanScale*2950,i.fishermanScale*3730);i.girl=new app.gfx.Sprite("girl","img/girl.png",2,2090,9690,i.fishermanScale*(8180/2),i.fishermanScale*7540);i.bucket=new app.gfx.Sprite("score.bucket","img/bucket.png",2,i.body.position.x+500,i.body.position.y+1e3,1970*i.fishermanScale,2080*i.fishermanScale);i.chick=new app.gfx.Sprite("chick","img/goldenChick.png",6,1530,3710,10680/6,2750);i.baloonLeft=new app.gfx.Text("baloonLeft","img/dialogLeft.png","",512,85,"ComicBookFont","#444",4210,6650,3820,3190,550,true,true,550,350,350,950);i.baloonRight=new app.gfx.Text("baloonRight","img/dialogRight.png","",512,85,"ComicBookFont","#444",4210,6650,3820,3190,550,true,true,550,350,350,950);i.scoreText=new app.gfx.BitmapText(3,"score.text","img/fontCifre.png","0123456789",3350,1230,1280,1280,640);i.price1Text=new app.gfx.BitmapText(2,"price1.text","img/fontCifre.png","0123456789",4250+600,4360+640,960,960,480);i.price2Text=new app.gfx.BitmapText(2,"price2.text","img/fontCifre.png","0123456789",6570+600,4360+640,960,960,480);i.price3Text=new app.gfx.BitmapText(2,"price3.text","img/fontCifre.png","0123456789",8770+600,4360+640,960,960,480);i.showingScore=0;i.earnedScore=0;i.whoosh=new app.sfx.Sound("whoosh","sfx/whoosh",313,false);i.hiscore=new app.sfx.Sound("hiscore","sfx/hiscore",3918,false);i.ding=new app.sfx.Sound("ding","sfx/ding",278,false);i.kvak=new app.sfx.Sound("kvak","sfx/kvak",524,false);i.sfx=new app.sfx.Channel("score");i.music=new app.sfx.Channel("music");e.init=function(a,t){e.loading(19,t);e.base.init(a,function(){app.sfx.Driver.current.loadSound(i.whoosh,e.loaded);app.sfx.Driver.current.loadSound(i.hiscore,e.loaded);app.sfx.Driver.current.loadSound(i.ding,e.loaded);app.sfx.Driver.current.loadSound(i.kvak,e.loaded);e.addSprite(i.exitSign,e.loaded);e.addSprite(i.trash1,e.loaded);e.addSprite(i.trash2,e.loaded);e.addSprite(i.trash3,e.loaded);e.addSprite(i.chick,e.loaded);e.addSprite(i.bucket,e.loaded);e.addSprite(i.body,e.loaded);e.addSprite(i.head,e.loaded);e.addSprite(i.girl,e.loaded);e.addSprite(i.baloonLeft,e.loaded);e.addSprite(i.baloonRight,e.loaded);i.trash1.frame(3);i.trash2.frame(3);i.trash3.frame(3);i.exitSign.show();i.bucket.show();i.body.show();i.head.show();i.girl.show();i.chick.animation([0,1,1,1,1,1,1,1,1,1],300);i.chick.show();i.scoreText.init(e,e.loaded);i.scoreText.frameskip(4,0);i.showingScore=i.earnedScore=app.ff.State.score();i.scoreText.text(i.showingScore);i.price1Text.init(e,e.loaded);i.price2Text.init(e,e.loaded);i.price3Text.init(e,e.loaded);i.price[1]=app.ff.State.fishPrice("fish1");i.price[2]=app.ff.State.fishPrice("fish2");i.price[3]=app.ff.State.fishPrice("fish3");i.price1Text.text(i.price[1]);i.price2Text.text(i.price[2]);i.price3Text.text(i.price[3]);i.exitSign.onclick=i.exitSignClicked;e.delay(3e3,i.dialogHeyFunky)})};e.cleanup=function(){i.music.stop();i.sfx.stop();app.sfx.Driver.current.removeSound(i.whoosh.id());app.sfx.Driver.current.removeSound(i.hiscore.id());e.base.cleanup();i=null;e=null};e.updateFrame=function(a){e.base.updateFrame(a);if(i.earnedScore>999){app.ff.State.fish("fish1",0);app.ff.State.fish("fish2",0);app.ff.State.fish("fish3",0);app.ff.State.fish("fish4",0);i.earnedScore=999}if(i.showingScore!=(i.earnedScore|0)){var t=(i.earnedScore|0)-i.showingScore;if(Math.abs(t)<1){i.showingScore=i.earnedScore|0}else{i.showingScore+=t/1|0}i.scoreText.text(i.showingScore)}};i.dialogHeyFunky=function(){i.baloonLeft.text(app.data.Strings.get("scoreSceneDialog1"));i.baloonLeft.show();e.delay(1500,i.dialogHeyGaiaPause)};i.dialogHeyGaiaPause=function(){i.baloonLeft.hide();e.delay(600,i.dialogHeyGaia)};i.dialogHeyGaia=function(){i.baloonRight.text(app.data.Strings.get("scoreSceneDialog2"));i.baloonRight.show();e.delay(1500,i.dialogHeresTheTrashPause)};i.dialogHeresTheTrashPause=function(){i.baloonRight.hide();e.delay(1e3,i.dialogHeresTheTrash)};i.dialogHeresTheTrash=function(){i.baloonRight.text(app.data.Strings.get("scoreSceneDialog3"));i.baloonRight.show();e.delay(4e3,i.bounceToGirl)};i.bounceToGirl=function(){i.baloonRight.hide();e.bounceTo(i.bucket.id(),i.girl.position.x+i.girl.size.x/2-i.bucket.size.x/2,i.girl.position.y+i.girl.size.y/2-i.bucket.size.y/2,4e3,400,i.startSorting,.5)};i.startSorting=function(){i.chick.animation([3,2,2,2,2,2,2,2,2,2],300);i.bucket.hide();i.girl.frame(1);i.sortNextTrash1()};i.sortNextTrash1=function(){var a=app.ff.State.fish("fish1");if(a===0){i.trash1.hide();return i.sortNextTrash2()}var t=a<5?a:5;app.ff.State.fish("fish1",a-t);i.earnedScore+=i.price[1]*t/100;i.sfx.play("whoosh");i.trash1.position.x=i.girl.position.x+i.girl.size.x/2-i.trash1.size.x/2;i.trash1.position.y=i.girl.position.y+i.girl.size.y/2-i.trash1.size.y/2;i.trash1.show();e.bounceTo(i.trash1.id(),4820-i.trash1.size.x/2,7300-i.trash1.size.y/2,8e3,400,i.sortNextTrash1,.5)};i.sortNextTrash2=function(){var a=app.ff.State.fish("fish2");if(a===0){i.trash2.hide();return i.sortNextTrash3()}var t=a<5?a:5;app.ff.State.fish("fish2",a-t);i.earnedScore+=i.price[2]*t/100;i.sfx.play("whoosh");i.trash2.position.x=i.girl.position.x+i.girl.size.x/2-i.trash2.size.x/2;i.trash2.position.y=i.girl.position.y+i.girl.size.y/2-i.trash2.size.y/2;i.trash2.show();e.bounceTo(i.trash2.id(),7150-i.trash2.size.x/2,7390-i.trash2.size.y/2,8e3,400,i.sortNextTrash2,.5)};i.sortNextTrash3=function(){var a=app.ff.State.fish("fish3");if(a===0){i.trash3.hide();return i.sortFinished()}var t=a<5?a:5;app.ff.State.fish("fish3",a-t);i.earnedScore+=i.price[3]*t/100;i.sfx.play("whoosh");i.trash3.position.x=i.girl.position.x+i.girl.size.x/2-i.trash3.size.x/2;i.trash3.position.y=i.girl.position.y+i.girl.size.y/2-i.trash3.size.y/2;i.trash3.show();e.bounceTo(i.trash3.id(),9320-i.trash3.size.x/2,7350-i.trash3.size.y/2,8e3,400,i.sortNextTrash3,.5)};i.sortFinished=function(){i.chick.animation([0,1,1,1,1,1,1,1,1,1],300);i.girl.frame(0);i.baloonLeft.text(app.data.Strings.get("scoreSceneDialog4"));i.baloonLeft.show();e.delay(4e3,i.bounceToFisherman)};i.bounceToFisherman=function(){i.baloonLeft.hide();i.bucket.show();e.bounceTo(i.bucket.id(),i.body.position.x+500,i.body.position.y+1e3,4e3,400,i.bucketReturned,.5)};i.bucketReturned=function(){i.baloonRight.text(app.data.Strings.get("scoreSceneDialog5"));i.baloonRight.show();e.delay(4e3,i.exitSignClicked)};i.exitSignClicked=function(){var a=app.ff.State.fish("fish1");while(a>0){var t=a<5?a:5;app.ff.State.fish("fish1",a-t);i.earnedScore+=i.price[1]*t/100}a=app.ff.State.fish("fish2");while(a>0){var t=a<5?a:5;app.ff.State.fish("fish2",a-t);i.earnedScore+=i.price[2]*t/100}a=app.ff.State.fish("fish3");if(a>0){var t=a<5?a:5;app.ff.State.fish("fish3",a-t);i.earnedScore+=i.price[3]*t/100}app.ff.State.score(i.earnedScore|0);i.baloonRight.hide();e.bounce(i.exitSign.id(),300,200,i.toMainMenu)};i.toMainMenu=function(){app.Scene.change(app.ff.MapScene)}};