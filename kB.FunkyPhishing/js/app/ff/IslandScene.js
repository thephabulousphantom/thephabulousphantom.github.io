app.ff.IslandScene=function(){var e=Class.inherit(this,app.Scene,["islandScene","img/creditsBackground.jpg"]);var t={};t.credits=app.data.Strings.get("credits"+(app.ff.State.score()===999&&app.ff.State.level()==3?4:app.ff.State.level())).split("\n");t.currentLine=0;t.linesPerPage=20;t.scrollingTime=1e4;t.headband=app.ff.State.level()==3?null:new app.gfx.Sprite("headband","img/headband"+app.ff.State.level()+".png",1,2830,4670,6690,6570);t.scrollingText=[new app.gfx.Text("scrollingText0",null,"",512,85,"ComicBookFont","#ff0",3e3,0,6e3,16e3,800,true),new app.gfx.Text("scrollingText1",null,"",512,85,"ComicBookFont","#ff0",3e3,16e3,6e3,16e3,800,true)];e.init=function(a,n){var i=new app.gfx.Position(6e3,0);var l=new app.gfx.Position(6e3,16e3);t.scrollingTime=1e3*(2*(l.getPhysicalY()-i.getPhysicalY()))/60|0;e.loading(t.headband?3:2,n);e.base.init(a,function(){e.addSprite(t.scrollingText[0],e.loaded);e.addSprite(t.scrollingText[1],e.loaded);if(t.headband){e.addSprite(t.headband,e.loaded);t.headband.show()}t.scrollingText[0].text(t.getNextCreditsText());t.scrollingText[1].text(t.getNextCreditsText());t.scrollingText[0].show();t.scrollingText[1].show();e.delay(app.ff.State.level()==3?3e3:1e4,t.startScrolling);app.ff.State.level(app.ff.State.level()+1);if(app.ff.State.level()==3){app.ff.State.enableMap("city");app.ff.State.enableMap("resort");app.ff.State.enableMap("island")}else{app.ff.State.disableMap("city");app.ff.State.disableMap("resort");app.ff.State.disableMap("island")}app.ff.State.mapPosition(0);app.ff.State.difficulty(app.ff.State.level())})};t.startScrolling=function(){if(t.headband){e.move(t.headband.id(),t.headband.position.x,4670-16e3,t.scrollingTime,t.headband.hide)}e.move(t.scrollingText[0].id(),3e3,-16e3,t.scrollingTime,t.onNextText);e.move(t.scrollingText[1].id(),3e3,-16e3,t.scrollingTime*2,t.onNextText)};t.getNextCreditsText=function(){var e="";var a=t.currentLine+t.linesPerPage;if(a>=t.credits.length){a=t.credits.length-1}if(t.currentLine==a){return undefined}for(;t.currentLine<a;t.currentLine++){e+=""+t.credits[t.currentLine].trim()+"\n"}return e};t.onNextText=function(a){var n=t.getNextCreditsText();if(!n){a.hide();e.delay(t.scrollingTime,t.toMap);return}a.text(n);a.position.x=3e3;a.position.y=16e3;e.move(a.id(),3e3,-16e3,t.scrollingTime*2,t.onNextText)};e.cleanup=function(){e.base.cleanup();t=null;e=null};e.updateFrame=function(t){e.base.updateFrame(t)};e.processCommand=function(a){if(e.base.processCommand(a)!=null){return}switch(a.code()){case"action":case"altaction":case"click":t.toMap();break}};t.toMap=function(){app.Scene.change(app.ff.MapScene)}};